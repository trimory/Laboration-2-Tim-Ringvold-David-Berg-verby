@using System.Text.Json;
@using Laboration2MVC.Models;
@model EditViewModel;
@{
    ViewData["Title"] = "Transaktioner";
    var apiResponse = Model.Transactions;
}

<div class="text-center">
    <h1 class="display-3">Välkommen till Stuxnets bank!</h1
        <h2>
        <a asp-controller="API" asp-action="TransactionView">
            Klicka här att återgå till transaktionslistan i visningsläge

        </a>
    </h2>
    <h2>Transaktionshistorik:</h2>

    @if (apiResponse != null)
    {
       Console.WriteLine(apiResponse);
       
        <table class="table">
            <thead>
                <tr>
                    <th>Ändra kategori</th>
                    <th>Transaktions-ID</th>
                    <th>Bokningsdatum</th>
                    <th>Transaktionsdatum</th>
                    <th>Referens</th>
                    <th>Belopp</th>
                    <th>Saldo efter transaktion</th>
                    <th>Kategori</th>
                </tr>
            </thead>
            <tbody>

                @foreach (var transaction in apiResponse)
                {
                    Console.WriteLine(transaction.TransactionID);
                    <tr>
                        <td>
                            <form asp-action="EditTransactionView" method="post">
                            <input asp-for="TransactionCategory.TransactionID" input type="hidden" value="@transaction.TransactionID" />
                            <input name="TransactionCategory.Category" class="form-control" required placeholder="Ange ny kategori" autocomplete="off" value="" />
                                <button type="submit" class="btn btn-primary">Spara</button>
                            </form> 
                        </td>
                        <td>@transaction.TransactionID</td>
                        <td>@transaction.BookingDate</td>
                        <td>@transaction.TransactionDate</td>
                        <td>@transaction.Reference
                            

                        </td>
                        
                        <td>@transaction.Amount</td>
                        <td>@transaction.Balance</td>
                        <td>@transaction.Category</td>  
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p>Du har ingen transaktionshistorik.</p>
    }

</div>
